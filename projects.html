<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planned & In-Progress Projects</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
    <div class="logo">âš¡ DREWCREW</div>
    <ul>
        <li><a href="index.html" >Home</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="projects.html" style="color:#4ea8ff">Projects</a></li>
        <li><a href="sql.html">SQL</a></li>
        <li><a href="contact.html">Contact Us</a></li>
    </ul>
</header>


    <div class="page-banner">
        <h1>Planned & In-Progress Projects</h1>
        <p>Data loaded from JSON, XML, and contractor lookup.</p>
    </div>


    <section class="table-section">

        <div class="two-column-tables">


            <div class="table-wrapper">
                <h2>Planned Projects (JSON)</h2>

                <table>
                    <thead>
                        <tr>
                            <th>Project Name</th>
                            <th>Status</th>
                            <th>Budget</th>
                            <th>Winning Bidder</th>
                            <th>Project HQ</th>
                        </tr>
                    </thead>
                    <tbody id="planned-table"></tbody>
                </table>
            </div>


            <div class="table-wrapper">
                <h2>In-Progress Projects (XML)</h2>

                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Status</th>
                            <th>Budget</th>
                            <th>Winning Bidder</th>
                            <th>Project HQ</th>
                        </tr>
                    </thead>
                    <tbody id="inprogress-table"></tbody>
                </table>
            </div>

        </div>
    </section>


<script>

function addCommas(num) {
    if (!num) return num;
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

var contractorLookup = {};


fetch("https://jay-iii.github.io/COMP1020/data-contractors.json")
    .then(res => res.json())
    .then(data => {


        for (var i = 0; i < data.length; i++) {
            contractorLookup[data[i].contractor_id] = data[i].company_name;
        }

        loadPlannedProjects();
        loadXMLProjects();
    });



function loadPlannedProjects() {

    fetch("https://jay-iii.github.io/COMP1020/data-Planned.json")
        .then(res => res.json())
        .then(list => {

            var table = document.getElementById("planned-table");

            for (var i = 0; i < list.length; i++) {

                var p = list[i];
                var winnerName = contractorLookup[p.winning_bidder];

                table.innerHTML +=
                    "<tr>" +
                    "<td>" + p.project_name + "</td>" +
                    "<td>" + p.project_status + "</td>" +
                    "<td>" + addCommas(p.budget) + "</td>" +
                    "<td>" + winnerName + "</td>" +
                    "<td>" + p.project_hq + "</td>" +
                    "</tr>";
            }
        });
}


function loadXMLProjects() {

    fetch("https://jay-iii.github.io/COMP1020/data-In-Progress.xml")
        .then(res => res.text())
        .then(text => {

            var xml = new DOMParser().parseFromString(text, "text/xml");
            var rows = xml.getElementsByTagName("Project");

            var table = document.getElementById("inprogress-table");

            for (var i = 0; i < rows.length; i++) {
                var p = rows[i];

                var name = p.getElementsByTagName("project_name")[0].textContent;
                var status = p.getElementsByTagName("project_status")[0].textContent;
                var budget = p.getElementsByTagName("budget")[0].textContent;
                var bidder = p.getElementsByTagName("winning_bidder")[0].textContent;
                var hq = p.getElementsByTagName("project_hq")[0].textContent;

                var bidderName = contractorLookup[bidder];

                table.innerHTML +=
                    "<tr>" +
                    "<td>" + name + "</td>" +
                    "<td>" + status + "</td>" +
                    "<td>" + addCommas(budget) + "</td>" +
                    "<td>" + bidderName + "</td>" +
                    "<td>" + hq + "</td>" +
                    "</tr>";
            }
        });
}

</script>

<footer>
    <h2>Our Proven Work Process</h2>

    <div class="footer-steps">
        <div class="footer-step">
            <h3>01</h3>
            <p>Consultation</p>
        </div>

        <div class="footer-step">
            <h3>02</h3>
            <p>Strategy</p>
        </div>

        <div class="footer-step">
            <h3>03</h3>
            <p>Implementation</p>
        </div>

        <div class="footer-step">
            <h3>04</h3>
            <p>Final Result</p>
        </div>
    </div>
</footer>


    
</body>
</html>









